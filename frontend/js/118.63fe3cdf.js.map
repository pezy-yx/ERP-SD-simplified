{"version":3,"file":"js/118.63fe3cdf.js","mappings":"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","sources":["webpack://site/./src/views/postingIncomingPayments/postingIncomingPayments.vue?e01b","webpack://site/./src/views/postingIncomingPayments/postingIncomingPayments.vue","webpack://site/./src/views/postingIncomingPayments/postingIncomingPayments.vue?a6d2"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, withModifiers as _withModifiers, vModelCheckbox as _vModelCheckbox, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"total\" }\nconst _hoisted_2 = { id: \"generalInfo\" }\nconst _hoisted_3 = { id: \"bankData\" }\nconst _hoisted_4 = { id: \"openItemSelection\" }\nconst _hoisted_5 = { style: {\"display\":\"flex\",\"justify-content\":\"space-between\",\"align-items\":\"center\",\"padding\":\"10px\"} }\nconst _hoisted_6 = { style: {\"display\":\"flex\",\"justify-content\":\"flex-end\"} }\nconst _hoisted_7 = { style: {\"font-weight\":\"bold\"} }\nconst _hoisted_8 = {\n  key: 0,\n  class: \"query-results-list\",\n  style: {\"width\":\"100%\"}\n}\nconst _hoisted_9 = { class: \"material-document-rows-container\" }\nconst _hoisted_10 = [\"onClick\"]\nconst _hoisted_11 = { class: \"row-item checkbox-cell\" }\nconst _hoisted_12 = [\"onUpdate:modelValue\"]\nconst _hoisted_13 = { class: \"row-item company-code\" }\nconst _hoisted_14 = { class: \"row-item account\" }\nconst _hoisted_15 = { class: \"row-item journal-entry\" }\nconst _hoisted_16 = { class: \"row-item journal-entry-type\" }\nconst _hoisted_17 = { class: \"row-item journal-entry-date\" }\nconst _hoisted_18 = { class: \"row-item net-due-date\" }\nconst _hoisted_19 = { class: \"row-item amount\" }\nconst _hoisted_20 = { class: \"row-item assignment\" }\nconst _hoisted_21 = {\n  key: 1,\n  class: \"query-results-list\",\n  style: {\"width\":\"100%\",\"text-align\":\"center\",\"padding\":\"20px\"}\n}\nconst _hoisted_22 = { class: \"table-footer-bar\" }\nconst _hoisted_23 = { class: \"select-all-checkbox\" }\nconst _hoisted_24 = [\"disabled\"]\nconst _hoisted_25 = { class: \"selected-items-count\" }\nconst _hoisted_26 = {\n  key: 2,\n  class: \"query-results-list\",\n  style: {\"width\":\"100%\"}\n}\nconst _hoisted_27 = { class: \"material-document-rows-container\" }\nconst _hoisted_28 = [\"onClick\"]\nconst _hoisted_29 = { class: \"row-item checkbox-cell\" }\nconst _hoisted_30 = [\"onUpdate:modelValue\"]\nconst _hoisted_31 = { class: \"row-item company-code\" }\nconst _hoisted_32 = { class: \"row-item account\" }\nconst _hoisted_33 = { class: \"row-item journal-entry\" }\nconst _hoisted_34 = { class: \"row-item journal-entry-type\" }\nconst _hoisted_35 = { class: \"row-item journal-entry-date\" }\nconst _hoisted_36 = { class: \"row-item net-due-date\" }\nconst _hoisted_37 = { class: \"row-item amount\" }\nconst _hoisted_38 = { class: \"row-item assignment\" }\nconst _hoisted_39 = {\n  key: 3,\n  class: \"query-results-list\",\n  style: {\"width\":\"100%\",\"text-align\":\"center\",\"padding\":\"20px\"}\n}\nconst _hoisted_40 = { class: \"table-footer-bar\" }\nconst _hoisted_41 = { class: \"select-all-checkbox\" }\nconst _hoisted_42 = [\"disabled\"]\nconst _hoisted_43 = { class: \"selected-items-count\" }\nconst _hoisted_44 = {\n  key: 4,\n  class: \"modal-overlay\"\n}\nconst _hoisted_45 = { class: \"modal-content\" }\n\nimport {ref, Ref, computed, onMounted,watch} from 'vue'\r\nimport VarBox from '@/components/varbox/VarBox.vue';\r\nimport AppContent from '@/components/applicationContent/AppContent.vue'\r\nimport {createTreeFromConfig, cns, VarNode, VarTree, NodeStructure} from '@/utils/VarTree';\r\nimport {\r\n    bpSearch,\r\n    GLAccountSearch,\r\n    CurrencyUnitSearch\r\n} from '@/utils/searchMethods'\r\nimport router from '@/router';\r\n\r\ninterface OpenItem {\r\n    companyCode: string;\r\n    account: string;\r\n    journalEntry: string;\r\n    journalEntryType: string;\r\n    journalEntryDate: string;\r\n    netDueDate: string;\r\n    amount: number;\r\n    assignment: string;\r\n    selected?: boolean;\r\n}\r\ntype State = 'input' | 'post'\r\n/**\r\n * @description 应用模式-输入、发布\r\n */\r\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'postingIncomingPayments',\n  setup(__props) {\n\r\nconst journalEntryTypeOptions = ['AA(Asset Posting)','AB(Accounting Document)','AF(Depreciation Pstngs)',\r\n    'AN(Net Asset Posting)','AP','CG','CH(Contract Settlement)','CR',\r\n    'DA(Customer Document)','DG(Customer Credit Memo)','DR(Customer Invoice)',\r\n    'DV','EU(Euro Rounding Diff.)','EX(External Number)','KA(Vendor Document)',\r\n    'KG(Vendor Credit Memo)','KN(Net Vendors)','KO','KP (Account Maintenance)',\r\n    'KR (Vendor Invoice)','KX','KZ (Vendor Payment)','M1 (MCA Journal)','M2 (FX Swap)',\r\n    'M3 (P&L Lock)','M4 (P&L Close)','M5 (P&L Transformation)','M6 (FX Valuation)',\r\n    'M7 (MAR & Restatement)','M8 (IFX Correction)','M9 (Reversal)',\r\n    'MD (Data Load)','ML (ML Settlement)','MR','P1','P3','P4','PR (Price Change)',\r\n    'RA (Sub.Cred.Memo Stlmt)','RB (Reserve for Bad Debt)','RE (Invoice - Gross)',\r\n    'RN (Invoice - Net)','RV (Billing Doc.Transfer)','SA (G/L Account Document)',\r\n    'SB (G/L Account Posting)','SK (Cash Document)','SU (Adjustment Document)',\r\n    'UE (Data Transfer)','WA (Goods Issue)','WE (Goods Receipt)','WI (Inventory Document)',\r\n    'WL (Goods Issue/Delivery)','WN (Net Goods Receipt)','XX','Y1','ZP (Payment Posting)',\r\n    'ZR (Bank Reconciliation)','ZS (Payment by Check)','ZV (Payment Clearing)',\r\n    'ZZ'\r\n]\r\n\r\nconst balance = ref(0 as number) // 用于存储余额\r\nconst balanceUnit = ref('EUR') // 用于存储余额单位\r\nconst API_BASE_URL = window.API_BASE_URL || ''\r\nconst appContentRef = ref(null) as any\r\nconst openItems : Ref<OpenItem[]> = ref([]) // 用于存储查询结果\r\n\r\nconst itemsToBeCleared: Ref<OpenItem[]> = ref([]) // 用于存储已选中的未清项\r\n\r\nconst selectedOpenItems = computed(() => {\r\n    return openItems.value.filter(item => item.selected);\r\n});\r\n\r\nconst selectedItemsToBeCleared = computed(() => {\r\n    return itemsToBeCleared.value.filter(item => item.selected);\r\n});\r\n\r\nconst allSelected_openItems = computed({\r\n    // getter: 判断是否所有项都被选中\r\n    get() {\r\n        // 如果没有 openItems，则全选框应为未选中状态 (或禁用)\r\n        if (openItems.value.length === 0) {\r\n            return false;\r\n        }\r\n        // 检查是否所有 openItems 都被选中\r\n        return selectedOpenItems.value.length === openItems.value.length;\r\n    },\r\n    // setter: 当全选勾选框改变时，更新所有项的选中状态\r\n    set(value: boolean) {\r\n        openItems.value.forEach(item => {\r\n            item.selected = value;\r\n        });\r\n    }\r\n});\r\n\r\nconst allSelected_itemsToBeCleared = computed({\r\n    // getter: 判断是否所有项都被选中\r\n    get() {\r\n        // 如果没有 itemsToBeCleared，则全选框应为未选中状态 (或禁用)\r\n        if (itemsToBeCleared.value.length === 0) {\r\n            return false;\r\n        }\r\n        // 检查是否所有 itemsToBeCleared 都被选中\r\n        return selectedItemsToBeCleared.value.length === itemsToBeCleared.value.length;\r\n    },\r\n    // setter: 当全选勾选框改变时，更新所有项的选中状态\r\n    set(value: boolean) {\r\n        itemsToBeCleared.value.forEach(item => {\r\n            item.selected = value;\r\n        });\r\n    }\r\n});\r\n\r\nconst showPostSuccessModal = ref(false);\r\nconst postedJournalEntryNumber = ref('');\r\n\r\n// 原始的大的 VarTree 定义 (作为整体数据结构的基础)\r\nconst inputTree = createTreeFromConfig(\r\n    cns('dict','dict','payment',null,false,{},[\r\n        cns('dict','dict','generalInformation',null,false,{},[\r\n            cns('string','leaf','Company Code',null,false,{searchMethods:bpSearch},[]),\r\n            cns('date','leaf','Posting Date',null,false,{},[]),\r\n            cns('date','leaf','Journal Entry Date',null,false,{},[]),\r\n            cns('selection','leaf','Journal Entry Type',null,false,{\r\n                options:journalEntryTypeOptions\r\n            },[]),\r\n            cns('string','leaf','Period',null,false,{},[]),\r\n        ],'General Information'),\r\n        cns('dict','dict','bankData',null,false,{},[\r\n            cns('number','leaf','G/L Account',null,false,{searchMethods:GLAccountSearch},[]),\r\n            cns('dict','dict','amount',null,false,{hideLabel:true},[\r\n                cns('number','leaf','amount',null,false,{},[]),\r\n                cns('string','leaf','unit','EUR',false,{searchMethods:CurrencyUnitSearch,hideLabel:true},[]),\r\n            ])\r\n        ],'Bank Data'),\r\n        cns('dict','dict','openItemSelection',null,false,{},[\r\n            cns('selection','leaf','accountType',null,false,{\r\n                options:['Customer','Vendor']\r\n            },[],'Account Type'),\r\n            cns('number','leaf','accountId',null,false,{searchMethods:bpSearch,hideLabel:true},[],'Account ID'),\r\n        ],'Open Item Selection'),\r\n    ],'Payment'),\r\n)\r\n\r\n// 定义三个新的 VarTree 引用，用于存储子树实例\r\nconst generalInfoTree: Ref<VarTree | null> = ref(null);\r\nconst bankDataTree: Ref<VarTree | null> = ref(null);\r\nconst openItemSelectionTree: Ref<VarTree | null> = ref(null);\r\n\r\n// 在组件挂载后，从原始的 inputTree 中提取子节点并创建新的 VarTree\r\nonMounted(() => {\r\n    // 1. 获取 'generalInformation' 节点并创建 VarTree\r\n    const generalInformationNode = inputTree.findNodeByPath(['generalInformation']);\r\n    if (generalInformationNode) {\r\n        generalInfoTree.value = new VarTree(generalInformationNode);\r\n    } else {\r\n        console.error(\"未能找到 generalInformation 节点\");\r\n    }\r\n\r\n    // 2. 获取 'bankData' 节点并创建 VarTree\r\n    const bankDataNode = inputTree.findNodeByPath(['bankData']);\r\n    if (bankDataNode) {\r\n        bankDataTree.value = new VarTree(bankDataNode);\r\n    } else {\r\n        console.error(\"未能找到 bankData 节点\");\r\n    }\r\n\r\n    // 3. 获取 'openItemSelection' 节点并创建 VarTree\r\n    const openItemSelectionNode = inputTree.findNodeByPath(['openItemSelection']);\r\n    if (openItemSelectionNode) {\r\n        openItemSelectionTree.value = new VarTree(openItemSelectionNode);\r\n    } else {\r\n        console.error(\"未能找到 openItemSelection 节点\");\r\n    }\r\n});\r\n\r\n\r\nconst state: Ref<State> = ref('input')\r\nconst onInputState = computed(() => state.value === 'input')\r\nconst onPostState = computed(() => state.value === 'post')\r\nfunction appToState(newState: State) {\r\n    state.value = newState\r\n}\r\n\r\n/**\r\n * @description 状态管理的before-next钩子\r\n */\r\nasync function handleExecute(currentStage: number, targetStage: number) {\r\n    console.log('try: stage change:',currentStage,'->',targetStage)\r\n    \r\n    //当从 'input' (0) 阶段点击 'Propose items' (即进入 'post' 阶段)\r\n    if(currentStage === 0){\r\n        //1. 获取输入数据\r\n        const inputData = inputTree.getValue();\r\n        console.log('待发送的输入数据:', inputData)\r\n\r\n        //2. 发送数据到后端\r\n        try{\r\n            const requestBody = {\r\n                generalInformation: inputData.generalInformation,\r\n                bankData: inputData.bankData,\r\n                openItemSelection: inputData.openItemSelection\r\n            };\r\n\r\n            const response = await fetch(`${API_BASE_URL}/api/finance/searchOpenItems`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(requestBody)\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            const result = await response.json();\r\n            console.log('后端的查询结果:', result);\r\n\r\n            //3. 处理响应数据\r\n            if (result.success && result.data) {\r\n                // 更新 openItems ref，用于在 post 阶段渲染\r\n                openItems.value = result.data.openItems ? result.data.openItems.map((item: OpenItem) => ({\r\n                    ...item,\r\n                    selected: false // 默认为未勾选\r\n                })) : [];\r\n                // 更新 balance 和 balanceUnit\r\n                balance.value = typeof result.data.balance === 'number' ? result.data.balance : parseFloat(result.data.balance || '0');\r\n                balanceUnit.value = result.data.balanceUnit || 'EUR';\r\n                \r\n                // 如果成功获取数据，允许跳转到下一阶段\r\n                return true; \r\n            } else {\r\n                // 后端返回成功但数据不符合预期\r\n                console.error('后端返回数据格式不正确:', result);\r\n                alert('查询未清项失败：' + (result.message || '数据格式错误'));\r\n                openItems.value = []; // 清空之前的可能数据\r\n                balance.value = 0;\r\n                balanceUnit.value = 'EUR';\r\n                return false; // 阻止跳转\r\n            }\r\n        } catch (error){\r\n            console.error('发送请求或处理响应时发生错误:', error);\r\n            alert('查询未清项失败，请检查网络或联系管理员。');\r\n            openItems.value = []; // 清空之前的可能数据\r\n            balance.value = 0;\r\n            balanceUnit.value = 'EUR';\r\n            return false; // 阻止跳转\r\n        }\r\n    }\r\n\r\n    if(currentStage === 1) {\r\n        // 当从 'post' (1) 阶段点击 'Post'，即提交数据\r\n        // 获取所有待清除的未清项\r\n        const itemsToPost = itemsToBeCleared.value;\r\n        console.log('准备提交的未清项:', itemsToPost);\r\n\r\n        if(balance.value < 0) {\r\n            alert('客户少付款，无法提交未清项。');\r\n            return false;\r\n        } else if(balance.value > 0) {\r\n            alert('客户多付款，无法提交未清项。');\r\n            return false;\r\n        } else {\r\n            try {\r\n                const response = await fetch(`${API_BASE_URL}/api/finance/postOpenItems`, {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(itemsToPost)\r\n                });\r\n                \r\n                const result = await response.json();\r\n\r\n                if (result.success) {\r\n                    postedJournalEntryNumber.value = result.data.mockJournalEntry.journalEntryId || 'N/A'; // 获取过账后的 Journal Entry Number\r\n                    showPostSuccessModal.value = true; // 显示过账成功的模态框\r\n                    appContentRef.value.footerMessage = ''; // 提供反馈\r\n                    console.log('过账成功:', result);\r\n                    return true;\r\n                } else {\r\n                    alert('过账失败：' + (result.message || '未知错误'));\r\n                    return false;\r\n                }   \r\n            } catch (error) {\r\n                console.error('过账时发生错误:', error);\r\n                alert('过账失败，请检查网络。');\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * @description 状态管理的before-prev钩子\r\n */\r\nasync function handleCancel(currentStage: number, _targetStage: number) {\r\n    if (currentStage === 1) { \r\n        const confirmValue = confirm('Cancel?')\r\n        if(confirmValue) {    \r\n            appContentRef.value.footerMessage = '';\r\n            openItems.value = [];\r\n            balance.value = 0;\r\n            balanceUnit.value = 'EUR';\r\n        }\r\n        console.log('取消操作，返回到输入阶段');\r\n        console.log('当前阶段:', currentStage, '目标阶段:', _targetStage);\r\n        console.log('确认值:', confirmValue);\r\n\r\n        appToState('input'); // 切换内部状态，控制 template 渲染\r\n\r\n        return confirmValue \r\n    }\r\n    return true \r\n}\r\n\r\n/**\r\n * @description 状态管理的after-next钩子\r\n */\r\nasync function handleAfterNext(_currentStage: number, _targetStage: number) {\r\n    // 导航到下一阶段后执行\r\n    if (_currentStage === 0) { // 如果导航到了 'post' 阶段\r\n        appToState('post'); // 切换内部状态，控制 template 渲染\r\n        appContentRef.value.footerMessage = 'Open items have been loaded'; // 可以在这里提供反馈\r\n    }\r\n}\r\n\r\n/**\r\n * @description 状态管理的after-prev钩子\r\n */\r\nasync function handleAfterPrev(_currentStage: number, _targetStage: number) {\r\n    // console.log('try: after-prev钩子被触发:', _currentStage, '->', _targetStage);\r\n    // // 导航到上一阶段后执行\r\n    // if (_targetStage === 0) { // 如果导航回到了 'input' 阶段\r\n    //     console.log('返回到输入阶段, handleAfterPrev钩子被触发');\r\n    //     appToState('input'); // 切换内部状态，控制 template 渲染\r\n    //     appContentRef.value.footerMessage = '输入信息！'; // 清空消息\r\n    // }\r\n}\r\n\r\n\r\n/**\r\n * @description 切换当前行的选中状态\r\n * @param item 当前行数据\r\n */\r\nfunction toggleRowSelection(item: OpenItem) {\r\n    // 切换当前行的 selected 状态\r\n    item.selected = !item.selected;\r\n}\r\n\r\n\r\n/**\r\n * @description 清账选中的未清项\r\n */\r\nfunction clearSelectedItems() {\r\n    const selectedItems = openItems.value.filter(item => item.selected);\r\n\r\n    if (selectedItems.length === 0) {\r\n        alert('请先选择要清除的未清项！');\r\n        return;\r\n    }\r\n\r\n    // 计算被清除项的总金额\r\n    let clearedAmount = 0;\r\n    selectedItems.forEach(item => {\r\n        clearedAmount += item.amount;\r\n    });\r\n\r\n    // 将选中的项添加到 itemsToBeCleared\r\n    itemsToBeCleared.value.push(...selectedItems);\r\n\r\n    // 从 openItems 中移除这些项\r\n    openItems.value = openItems.value.filter(item => !item.selected);\r\n\r\n    // 更新 balance：从当前余额中减去被清除项的总金额\r\n    balance.value -= clearedAmount;\r\n\r\n    // 重置 itemsToBeCleared 中项的 selected 状态\r\n    itemsToBeCleared.value.forEach(item => {\r\n        item.selected = false;\r\n    });\r\n\r\n    console.log(`成功清除 ${selectedItems.length} 项未清项。`);\r\n}\r\n\r\n/**\r\n * @description 移除 itemsToBeCleared 中的选中项\r\n */\r\nfunction removeItemsToBeCleared() {\r\n    const selectedItems = itemsToBeCleared.value.filter(item => item.selected);\r\n\r\n    if (selectedItems.length === 0) {\r\n        alert('请先选择要移除的项！');\r\n        return;\r\n    }\r\n\r\n    openItems.value.push(...selectedItems); // 将选中的项重新添加到 openItems\r\n\r\n    // 从 itemsToBeCleared 中移除选中的项\r\n    itemsToBeCleared.value = itemsToBeCleared.value.filter(item => !item.selected);\r\n\r\n    // 更新 balance：将被移除项的金额加回到余额中\r\n    let removedAmount = 0;\r\n    selectedItems.forEach(item => {\r\n        removedAmount += item.amount;\r\n    });\r\n    balance.value += removedAmount;\r\n\r\n    // 重置 itemsToBeCleared 中项的 selected 状态\r\n    itemsToBeCleared.value.forEach(item => {\r\n        item.selected = false;\r\n    });\r\n\r\n    console.log(`成功移除 ${selectedItems.length} 项已清除项。`);\r\n}\r\n\r\n/**\r\n * @description 关闭过账成功模态框\r\n */\r\nfunction closePostSuccessModal() {\r\n    showPostSuccessModal.value = false;\r\n\r\n    console.log('关闭过账成功模态框');\r\n    openItems.value = [];\r\n    itemsToBeCleared.value = [];\r\n    balance.value = 0;\r\n    balanceUnit.value = 'EUR';\r\n    appContentRef.value.goToStage(0); // 返回到输入阶段\r\n    appToState('input'); // 切换内部状态，控制 template 渲染\r\n}\r\n\r\n\r\n/**\r\n * @description 查看过账成功的 Journal Entry 详情\r\n */\r\nfunction viewJournalEntryDetails() {\r\n    // 隐藏成功提示模态框\r\n    showPostSuccessModal.value = false;\r\n\r\n    if (postedJournalEntryNumber.value) {\r\n        // 跳转到新的详情路由，并传递凭证编号作为参数\r\n        router.push({\r\n            name: 'DisplayJournalEntry', // 路由名称\r\n            params: { id: postedJournalEntryNumber.value } // 传递参数\r\n        });\r\n    } else {\r\n        alert('无法获取凭证编号进行查看。');\r\n    }\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createBlock(AppContent, {\n    stages: ['input','post'],\n    \"before-next\": handleExecute,\n    \"before-prev\": handleCancel,\n    \"after-next\": handleAfterNext,\n    \"after-prev\": handleAfterPrev,\n    \"footer-config\": [\r\n        { nextText: 'Propose items' },\r\n        { prevText: 'Cancel', nextText: 'Post' },\r\n        ],\n    ref_key: \"appContentRef\",\n    ref: appContentRef\n  }, {\n    [`stage-input`]: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n          _withDirectives(_createVNode(VarBox, {\n            tree: generalInfoTree.value!\n          }, null, 8, [\"tree\"]), [\n            [_vShow, onInputState.value]\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_3, [\n          _withDirectives(_createVNode(VarBox, {\n            tree: bankDataTree.value!\n          }, null, 8, [\"tree\"]), [\n            [_vShow, onInputState.value]\n          ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_4, [\n          _withDirectives(_createVNode(VarBox, {\n            tree: openItemSelectionTree.value!\n          }, null, 8, [\"tree\"]), [\n            [_vShow, onInputState.value]\n          ])\n        ])\n      ])\n    ]),\n    [`stage-post`]: _withCtx(() => [\n      _createElementVNode(\"div\", _hoisted_5, [\n        _cache[4] || (_cache[4] = _createElementVNode(\"div\", null, [\n          _createElementVNode(\"span\", { style: {\"font-weight\":\"bold\"} }, \"Open Items\")\n        ], -1)),\n        _createElementVNode(\"div\", _hoisted_6, [\n          _createElementVNode(\"span\", _hoisted_7, \"Balance:  \" + _toDisplayString(balance.value + ' ' + balanceUnit.value), 1)\n        ])\n      ]),\n      (openItems.value && openItems.value.length > 0)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n            _createElementVNode(\"div\", _hoisted_9, [\n              _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"material-document-row-header\" }, [\n                _createElementVNode(\"div\", { class: \"header-item checkbox-header\" }, \"No.\"),\n                _createElementVNode(\"div\", { class: \"header-item company-code\" }, \"Company Code\"),\n                _createElementVNode(\"div\", { class: \"header-item account\" }, \"Account\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry\" }, \"Journal Entry\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry-type\" }, \"Journal Entry Type\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry-date\" }, \"Journal Entry Date\"),\n                _createElementVNode(\"div\", { class: \"header-item net-due-date\" }, \"Net Due Date\"),\n                _createElementVNode(\"div\", { class: \"header-item amount\" }, \"Amount\"),\n                _createElementVNode(\"div\", { class: \"header-item assignment\" }, \"Assignment\"),\n                _createElementVNode(\"div\", { class: \"header-item\" })\n              ], -1)),\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(openItems.value, (item, index) => {\n                return (_openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"material-document-row\",\n                  onClick: ($event: any) => (toggleRowSelection(item))\n                }, [\n                  _createElementVNode(\"div\", _hoisted_11, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      type: \"checkbox\",\n                      onClick: _cache[0] || (_cache[0] = _withModifiers(() => {}, [\"stop\"])),\n                      \"onUpdate:modelValue\": ($event: any) => ((item.selected) = $event)\n                    }, null, 8, _hoisted_12), [\n                      [_vModelCheckbox, item.selected]\n                    ])\n                  ]),\n                  _createElementVNode(\"span\", _hoisted_13, _toDisplayString(item.companyCode), 1),\n                  _createElementVNode(\"span\", _hoisted_14, _toDisplayString(item.account), 1),\n                  _createElementVNode(\"span\", _hoisted_15, _toDisplayString(item.journalEntry), 1),\n                  _createElementVNode(\"span\", _hoisted_16, _toDisplayString(item.journalEntryType), 1),\n                  _createElementVNode(\"span\", _hoisted_17, _toDisplayString(item.journalEntryDate), 1),\n                  _createElementVNode(\"span\", _hoisted_18, _toDisplayString(item.netDueDate), 1),\n                  _createElementVNode(\"span\", _hoisted_19, _toDisplayString(item.amount), 1),\n                  _createElementVNode(\"span\", _hoisted_20, _toDisplayString(item.assignment), 1),\n                  _cache[5] || (_cache[5] = _createElementVNode(\"span\", { class: \"row-item arrow-icon\" }, \"▶\", -1))\n                ], 8, _hoisted_10))\n              }), 128))\n            ])\n          ]))\n        : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, _cache[7] || (_cache[7] = [\n            _createElementVNode(\"p\", null, \"No open items found.\", -1)\n          ]))),\n      _createElementVNode(\"div\", _hoisted_22, [\n        _createElementVNode(\"div\", _hoisted_23, [\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"checkbox\",\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((allSelected_openItems).value = $event)),\n            disabled: openItems.value.length === 0\n          }, null, 8, _hoisted_24), [\n            [_vModelCheckbox, allSelected_openItems.value]\n          ]),\n          _cache[8] || (_cache[8] = _createElementVNode(\"span\", null, \"Select All\", -1))\n        ]),\n        _createElementVNode(\"div\", _hoisted_25, [\n          _createElementVNode(\"span\", null, \"Already Selected \" + _toDisplayString(selectedOpenItems.value.length) + \" / Total \" + _toDisplayString(openItems.value.length), 1)\n        ])\n      ]),\n      _createElementVNode(\"div\", { class: \"btn-container\" }, [\n        _createElementVNode(\"button\", {\n          class: \"btn\",\n          onClick: clearSelectedItems\n        }, \" clear \"),\n        _createElementVNode(\"button\", {\n          class: \"btn\",\n          onClick: removeItemsToBeCleared\n        }, \" remove \")\n      ]),\n      _cache[16] || (_cache[16] = _createElementVNode(\"div\", { style: {\"display\":\"flex\",\"justify-content\":\"space-between\",\"align-items\":\"center\",\"padding\":\"10px\"} }, [\n        _createElementVNode(\"span\", { style: {\"font-weight\":\"bold\"} }, \"Items to be cleared\")\n      ], -1)),\n      (itemsToBeCleared.value && itemsToBeCleared.value.length > 0)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [\n            _createElementVNode(\"div\", _hoisted_27, [\n              _cache[10] || (_cache[10] = _createElementVNode(\"div\", { class: \"material-document-row-header\" }, [\n                _createElementVNode(\"div\", { class: \"header-item checkbox-header\" }, \"No.\"),\n                _createElementVNode(\"div\", { class: \"header-item company-code\" }, \"Company Code\"),\n                _createElementVNode(\"div\", { class: \"header-item account\" }, \"Account\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry\" }, \"Journal Entry\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry-type\" }, \"Journal Entry Type\"),\n                _createElementVNode(\"div\", { class: \"header-item journal-entry-date\" }, \"Journal Entry Date\"),\n                _createElementVNode(\"div\", { class: \"header-item net-due-date\" }, \"Net Due Date\"),\n                _createElementVNode(\"div\", { class: \"header-item amount\" }, \"Amount\"),\n                _createElementVNode(\"div\", { class: \"header-item assignment\" }, \"Assignment\"),\n                _createElementVNode(\"div\", { class: \"header-item\" })\n              ], -1)),\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(itemsToBeCleared.value, (item, index) => {\n                return (_openBlock(), _createElementBlock(\"div\", {\n                  key: index,\n                  class: \"material-document-row\",\n                  onClick: ($event: any) => (toggleRowSelection(item))\n                }, [\n                  _createElementVNode(\"div\", _hoisted_29, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                      type: \"checkbox\",\n                      onClick: _cache[2] || (_cache[2] = _withModifiers(() => {}, [\"stop\"])),\n                      \"onUpdate:modelValue\": ($event: any) => ((item.selected) = $event)\n                    }, null, 8, _hoisted_30), [\n                      [_vModelCheckbox, item.selected]\n                    ])\n                  ]),\n                  _createElementVNode(\"span\", _hoisted_31, _toDisplayString(item.companyCode), 1),\n                  _createElementVNode(\"span\", _hoisted_32, _toDisplayString(item.account), 1),\n                  _createElementVNode(\"span\", _hoisted_33, _toDisplayString(item.journalEntry), 1),\n                  _createElementVNode(\"span\", _hoisted_34, _toDisplayString(item.journalEntryType), 1),\n                  _createElementVNode(\"span\", _hoisted_35, _toDisplayString(item.journalEntryDate), 1),\n                  _createElementVNode(\"span\", _hoisted_36, _toDisplayString(item.netDueDate), 1),\n                  _createElementVNode(\"span\", _hoisted_37, _toDisplayString(item.amount), 1),\n                  _createElementVNode(\"span\", _hoisted_38, _toDisplayString(item.assignment), 1),\n                  _cache[9] || (_cache[9] = _createElementVNode(\"span\", { class: \"row-item arrow-icon\" }, \"▶\", -1))\n                ], 8, _hoisted_28))\n              }), 128))\n            ])\n          ]))\n        : (_openBlock(), _createElementBlock(\"div\", _hoisted_39, _cache[11] || (_cache[11] = [\n            _createElementVNode(\"p\", null, \"No items to be cleared.\", -1)\n          ]))),\n      _createElementVNode(\"div\", _hoisted_40, [\n        _createElementVNode(\"div\", _hoisted_41, [\n          _withDirectives(_createElementVNode(\"input\", {\n            type: \"checkbox\",\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((allSelected_itemsToBeCleared).value = $event)),\n            disabled: itemsToBeCleared.value.length === 0\n          }, null, 8, _hoisted_42), [\n            [_vModelCheckbox, allSelected_itemsToBeCleared.value]\n          ]),\n          _cache[12] || (_cache[12] = _createElementVNode(\"span\", null, \"Select All\", -1))\n        ]),\n        _createElementVNode(\"div\", _hoisted_43, [\n          _createElementVNode(\"span\", null, \"Already Selected \" + _toDisplayString(selectedItemsToBeCleared.value.length) + \" / Total \" + _toDisplayString(itemsToBeCleared.value.length), 1)\n        ])\n      ]),\n      (showPostSuccessModal.value)\n        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_44, [\n            _createElementVNode(\"div\", _hoisted_45, [\n              _cache[15] || (_cache[15] = _createElementVNode(\"h2\", null, \"Success\", -1)),\n              _createElementVNode(\"span\", null, [\n                _cache[13] || (_cache[13] = _createTextVNode(\"Journal Entry \")),\n                _createElementVNode(\"span\", null, _toDisplayString(postedJournalEntryNumber.value), 1),\n                _cache[14] || (_cache[14] = _createTextVNode(\" Successfully Posted\"))\n              ]),\n              _createElementVNode(\"div\", { class: \"modal-actions\" }, [\n                _createElementVNode(\"button\", {\n                  class: \"btn\",\n                  onClick: viewJournalEntryDetails\n                }, \"View Details\"),\n                _createElementVNode(\"button\", {\n                  class: \"btn\",\n                  onClick: closePostSuccessModal\n                }, \"Close\")\n              ])\n            ])\n          ]))\n        : _createCommentVNode(\"\", true)\n    ]),\n    [`footer-content-right`]: _withCtx(() => [\n      _createTextVNode(_toDisplayString(appContentRef.value?.getCurrentStageName()), 1)\n    ]),\n    _: 2\n  }, 1536))\n}\n}\n\n})","<template>\r\n    <AppContent\r\n        :stages=\"['input','post']\"\r\n        :before-next=\"handleExecute\"\r\n        :before-prev=\"handleCancel\"\r\n        :after-next=\"handleAfterNext\"\r\n        :after-prev=\"handleAfterPrev\"\r\n        :footer-config=\"[\r\n        { nextText: 'Propose items' },\r\n        { prevText: 'Cancel', nextText: 'Post' },\r\n        ]\"\r\n        ref=\"appContentRef\"\r\n    >\r\n        <template #[`stage-input`]>\r\n            <div class=\"total\">\r\n                <div id=\"generalInfo\">\r\n                    <VarBox\r\n                        :tree=\"generalInfoTree!\"\r\n                        v-show=\"onInputState\"\r\n                    ></VarBox> \r\n                </div>\r\n                <div id=\"bankData\">\r\n                    <VarBox\r\n                        :tree=\"bankDataTree!\"\r\n                        v-show=\"onInputState\"\r\n                    ></VarBox>\r\n                </div>\r\n                <div id=\"openItemSelection\">\r\n                    <VarBox\r\n                        :tree=\"openItemSelectionTree!\"\r\n                        v-show=\"onInputState\"\r\n                    ></VarBox>\r\n                </div>\r\n            </div>\r\n        </template>\r\n        <template #[`stage-post`]>\r\n            <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 10px;\">\r\n                <div>\r\n                    <span style=\"font-weight:bold\">Open Items</span>\r\n                </div>\r\n                <div style=\"display: flex; justify-content: flex-end;\">\r\n                    <span style=\"font-weight:bold\">Balance:&nbsp;&nbsp;{{balance + ' ' + balanceUnit}}</span>\r\n                </div>  \r\n            </div>\r\n            <div v-if=\"openItems && openItems.length > 0\" class=\"query-results-list\" style=\"width: 100%;\">\r\n                <div class=\"material-document-rows-container\">\r\n                    <div class=\"material-document-row-header\">\r\n                        <div class=\"header-item checkbox-header\">No.</div>\r\n                        <div class=\"header-item company-code\">Company Code</div>\r\n                        <div class=\"header-item account\">Account</div>\r\n                        <div class=\"header-item journal-entry\">Journal Entry</div>\r\n                        <div class=\"header-item journal-entry-type\">Journal Entry Type</div>\r\n                        <div class=\"header-item journal-entry-date\">Journal Entry Date</div>\r\n                        <div class=\"header-item net-due-date\">Net Due Date</div>\r\n                        <div class=\"header-item amount\">Amount</div>\r\n                        <div class=\"header-item assignment\">Assignment</div>\r\n                        <div class=\"header-item\"></div>\r\n                    </div>\r\n                    <div v-for=\"(item,index) in openItems\" :key=\"index\" class=\"material-document-row\" @click=\"toggleRowSelection(item)\">\r\n                        <div class=\"row-item checkbox-cell\">\r\n                            <input type=\"checkbox\" @click.stop v-model=\"item.selected\">\r\n                        </div>\r\n                        <span class=\"row-item company-code\">{{item.companyCode}}</span>\r\n                        <span class=\"row-item account\">{{item.account}}</span>\r\n                        <span class=\"row-item journal-entry\">{{item.journalEntry}}</span>\r\n                        <span class=\"row-item journal-entry-type\">{{item.journalEntryType}}</span>\r\n                        <span class=\"row-item journal-entry-date\">{{item.journalEntryDate}}</span>\r\n                        <span class=\"row-item net-due-date\">{{item.netDueDate}}</span>\r\n                        <span class=\"row-item amount\">{{item.amount}}</span>\r\n                        <span class=\"row-item assignment\">{{item.assignment}}</span>\r\n                        <span class=\"row-item arrow-icon\">▶</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div v-else class=\"query-results-list\" style=\"width: 100%;text-align: center; padding: 20px;\">\r\n                <p>No open items found.</p>\r\n            </div>\r\n            <div class=\"table-footer-bar\">\r\n                <div class=\"select-all-checkbox\">\r\n                    <input type=\"checkbox\" v-model=\"allSelected_openItems\" :disabled=\"openItems.length === 0\">\r\n                    <span>Select All</span>\r\n                </div>\r\n                <div class=\"selected-items-count\">\r\n                    <span>Already Selected {{ selectedOpenItems.length }} / Total {{ openItems.length }}</span>\r\n                </div>\r\n            </div>\r\n\r\n            <div class=\"btn-container\">\r\n                <button class=\"btn\" @click=\"clearSelectedItems\">\r\n                    clear\r\n                </button>\r\n                <button class=\"btn\" @click=\"removeItemsToBeCleared\">\r\n                    remove\r\n                </button>\r\n            </div>\r\n            <div style=\"display: flex; justify-content: space-between; align-items: center; padding: 10px;\">\r\n                <span style=\"font-weight:bold\">Items to be cleared</span>\r\n            </div>\r\n            <div v-if=\"itemsToBeCleared && itemsToBeCleared.length > 0\" class=\"query-results-list\" style=\"width: 100%;\">\r\n                <div class=\"material-document-rows-container\">\r\n                    <div class=\"material-document-row-header\">\r\n                        <div class=\"header-item checkbox-header\">No.</div>\r\n                        <div class=\"header-item company-code\">Company Code</div>\r\n                        <div class=\"header-item account\">Account</div>\r\n                        <div class=\"header-item journal-entry\">Journal Entry</div>\r\n                        <div class=\"header-item journal-entry-type\">Journal Entry Type</div>\r\n                        <div class=\"header-item journal-entry-date\">Journal Entry Date</div>\r\n                        <div class=\"header-item net-due-date\">Net Due Date</div>\r\n                        <div class=\"header-item amount\">Amount</div>\r\n                        <div class=\"header-item assignment\">Assignment</div>\r\n                        <div class=\"header-item\"></div>\r\n                    </div>\r\n                    <div v-for=\"(item,index) in itemsToBeCleared\" :key=\"index\" class=\"material-document-row\" @click=\"toggleRowSelection(item)\">\r\n                        <div class=\"row-item checkbox-cell\">\r\n                            <input type=\"checkbox\" @click.stop v-model=\"item.selected\">\r\n                        </div>\r\n                        <span class=\"row-item company-code\">{{item.companyCode}}</span>\r\n                        <span class=\"row-item account\">{{item.account}}</span>\r\n                        <span class=\"row-item journal-entry\">{{item.journalEntry}}</span>\r\n                        <span class=\"row-item journal-entry-type\">{{item.journalEntryType}}</span>\r\n                        <span class=\"row-item journal-entry-date\">{{item.journalEntryDate}}</span>\r\n                        <span class=\"row-item net-due-date\">{{item.netDueDate}}</span>\r\n                        <span class=\"row-item amount\">{{item.amount}}</span>\r\n                        <span class=\"row-item assignment\">{{item.assignment}}</span>\r\n                        <span class=\"row-item arrow-icon\">▶</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div v-else class=\"query-results-list\" style=\"width: 100%;text-align: center; padding: 20px;\">\r\n                <p>No items to be cleared.</p>\r\n            </div>\r\n            <div class=\"table-footer-bar\">\r\n                <div class=\"select-all-checkbox\">\r\n                    <input type=\"checkbox\" v-model=\"allSelected_itemsToBeCleared\" :disabled=\"itemsToBeCleared.length === 0\">\r\n                    <span>Select All</span>\r\n                </div>\r\n                <div class=\"selected-items-count\">\r\n                    <span>Already Selected {{ selectedItemsToBeCleared.length }} / Total {{ itemsToBeCleared.length }}</span>\r\n                </div>\r\n            </div>\r\n            <div v-if=\"showPostSuccessModal\" class=\"modal-overlay\">\r\n                <div class=\"modal-content\">\r\n                    <h2>Success</h2>\r\n                    <span>Journal Entry&nbsp;<span>{{ postedJournalEntryNumber }}</span>&nbsp;Successfully Posted</span>\r\n                    <div class=\"modal-actions\">\r\n                        <button class=\"btn\" @click=\"viewJournalEntryDetails\">View Details</button>\r\n                        <button class=\"btn\" @click=\"closePostSuccessModal\">Close</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </template>\r\n\r\n        <template #[`footer-content-right`]>\r\n        {{ appContentRef?.getCurrentStageName() }}\r\n        </template>\r\n\r\n    </AppContent>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport {ref, Ref, computed, onMounted,watch} from 'vue'\r\nimport VarBox from '@/components/varbox/VarBox.vue';\r\nimport AppContent from '@/components/applicationContent/AppContent.vue'\r\nimport {createTreeFromConfig, cns, VarNode, VarTree, NodeStructure} from '@/utils/VarTree';\r\nimport {\r\n    bpSearch,\r\n    GLAccountSearch,\r\n    CurrencyUnitSearch\r\n} from '@/utils/searchMethods'\r\nimport router from '@/router';\r\n\r\nconst journalEntryTypeOptions = ['AA(Asset Posting)','AB(Accounting Document)','AF(Depreciation Pstngs)',\r\n    'AN(Net Asset Posting)','AP','CG','CH(Contract Settlement)','CR',\r\n    'DA(Customer Document)','DG(Customer Credit Memo)','DR(Customer Invoice)',\r\n    'DV','EU(Euro Rounding Diff.)','EX(External Number)','KA(Vendor Document)',\r\n    'KG(Vendor Credit Memo)','KN(Net Vendors)','KO','KP (Account Maintenance)',\r\n    'KR (Vendor Invoice)','KX','KZ (Vendor Payment)','M1 (MCA Journal)','M2 (FX Swap)',\r\n    'M3 (P&L Lock)','M4 (P&L Close)','M5 (P&L Transformation)','M6 (FX Valuation)',\r\n    'M7 (MAR & Restatement)','M8 (IFX Correction)','M9 (Reversal)',\r\n    'MD (Data Load)','ML (ML Settlement)','MR','P1','P3','P4','PR (Price Change)',\r\n    'RA (Sub.Cred.Memo Stlmt)','RB (Reserve for Bad Debt)','RE (Invoice - Gross)',\r\n    'RN (Invoice - Net)','RV (Billing Doc.Transfer)','SA (G/L Account Document)',\r\n    'SB (G/L Account Posting)','SK (Cash Document)','SU (Adjustment Document)',\r\n    'UE (Data Transfer)','WA (Goods Issue)','WE (Goods Receipt)','WI (Inventory Document)',\r\n    'WL (Goods Issue/Delivery)','WN (Net Goods Receipt)','XX','Y1','ZP (Payment Posting)',\r\n    'ZR (Bank Reconciliation)','ZS (Payment by Check)','ZV (Payment Clearing)',\r\n    'ZZ'\r\n]\r\n\r\nconst balance = ref(0 as number) // 用于存储余额\r\nconst balanceUnit = ref('EUR') // 用于存储余额单位\r\nconst API_BASE_URL = window.API_BASE_URL || ''\r\nconst appContentRef = ref(null) as any\r\ninterface OpenItem {\r\n    companyCode: string;\r\n    account: string;\r\n    journalEntry: string;\r\n    journalEntryType: string;\r\n    journalEntryDate: string;\r\n    netDueDate: string;\r\n    amount: number;\r\n    assignment: string;\r\n    selected?: boolean;\r\n}\r\nconst openItems : Ref<OpenItem[]> = ref([]) // 用于存储查询结果\r\n\r\nconst itemsToBeCleared: Ref<OpenItem[]> = ref([]) // 用于存储已选中的未清项\r\n\r\nconst selectedOpenItems = computed(() => {\r\n    return openItems.value.filter(item => item.selected);\r\n});\r\n\r\nconst selectedItemsToBeCleared = computed(() => {\r\n    return itemsToBeCleared.value.filter(item => item.selected);\r\n});\r\n\r\nconst allSelected_openItems = computed({\r\n    // getter: 判断是否所有项都被选中\r\n    get() {\r\n        // 如果没有 openItems，则全选框应为未选中状态 (或禁用)\r\n        if (openItems.value.length === 0) {\r\n            return false;\r\n        }\r\n        // 检查是否所有 openItems 都被选中\r\n        return selectedOpenItems.value.length === openItems.value.length;\r\n    },\r\n    // setter: 当全选勾选框改变时，更新所有项的选中状态\r\n    set(value: boolean) {\r\n        openItems.value.forEach(item => {\r\n            item.selected = value;\r\n        });\r\n    }\r\n});\r\n\r\nconst allSelected_itemsToBeCleared = computed({\r\n    // getter: 判断是否所有项都被选中\r\n    get() {\r\n        // 如果没有 itemsToBeCleared，则全选框应为未选中状态 (或禁用)\r\n        if (itemsToBeCleared.value.length === 0) {\r\n            return false;\r\n        }\r\n        // 检查是否所有 itemsToBeCleared 都被选中\r\n        return selectedItemsToBeCleared.value.length === itemsToBeCleared.value.length;\r\n    },\r\n    // setter: 当全选勾选框改变时，更新所有项的选中状态\r\n    set(value: boolean) {\r\n        itemsToBeCleared.value.forEach(item => {\r\n            item.selected = value;\r\n        });\r\n    }\r\n});\r\n\r\nconst showPostSuccessModal = ref(false);\r\nconst postedJournalEntryNumber = ref('');\r\n\r\n// 原始的大的 VarTree 定义 (作为整体数据结构的基础)\r\nconst inputTree = createTreeFromConfig(\r\n    cns('dict','dict','payment',null,false,{},[\r\n        cns('dict','dict','generalInformation',null,false,{},[\r\n            cns('string','leaf','Company Code',null,false,{searchMethods:bpSearch},[]),\r\n            cns('date','leaf','Posting Date',null,false,{},[]),\r\n            cns('date','leaf','Journal Entry Date',null,false,{},[]),\r\n            cns('selection','leaf','Journal Entry Type',null,false,{\r\n                options:journalEntryTypeOptions\r\n            },[]),\r\n            cns('string','leaf','Period',null,false,{},[]),\r\n        ],'General Information'),\r\n        cns('dict','dict','bankData',null,false,{},[\r\n            cns('number','leaf','G/L Account',null,false,{searchMethods:GLAccountSearch},[]),\r\n            cns('dict','dict','amount',null,false,{hideLabel:true},[\r\n                cns('number','leaf','amount',null,false,{},[]),\r\n                cns('string','leaf','unit','EUR',false,{searchMethods:CurrencyUnitSearch,hideLabel:true},[]),\r\n            ])\r\n        ],'Bank Data'),\r\n        cns('dict','dict','openItemSelection',null,false,{},[\r\n            cns('selection','leaf','accountType',null,false,{\r\n                options:['Customer','Vendor']\r\n            },[],'Account Type'),\r\n            cns('number','leaf','accountId',null,false,{searchMethods:bpSearch,hideLabel:true},[],'Account ID'),\r\n        ],'Open Item Selection'),\r\n    ],'Payment'),\r\n)\r\n\r\n// 定义三个新的 VarTree 引用，用于存储子树实例\r\nconst generalInfoTree: Ref<VarTree | null> = ref(null);\r\nconst bankDataTree: Ref<VarTree | null> = ref(null);\r\nconst openItemSelectionTree: Ref<VarTree | null> = ref(null);\r\n\r\n// 在组件挂载后，从原始的 inputTree 中提取子节点并创建新的 VarTree\r\nonMounted(() => {\r\n    // 1. 获取 'generalInformation' 节点并创建 VarTree\r\n    const generalInformationNode = inputTree.findNodeByPath(['generalInformation']);\r\n    if (generalInformationNode) {\r\n        generalInfoTree.value = new VarTree(generalInformationNode);\r\n    } else {\r\n        console.error(\"未能找到 generalInformation 节点\");\r\n    }\r\n\r\n    // 2. 获取 'bankData' 节点并创建 VarTree\r\n    const bankDataNode = inputTree.findNodeByPath(['bankData']);\r\n    if (bankDataNode) {\r\n        bankDataTree.value = new VarTree(bankDataNode);\r\n    } else {\r\n        console.error(\"未能找到 bankData 节点\");\r\n    }\r\n\r\n    // 3. 获取 'openItemSelection' 节点并创建 VarTree\r\n    const openItemSelectionNode = inputTree.findNodeByPath(['openItemSelection']);\r\n    if (openItemSelectionNode) {\r\n        openItemSelectionTree.value = new VarTree(openItemSelectionNode);\r\n    } else {\r\n        console.error(\"未能找到 openItemSelection 节点\");\r\n    }\r\n});\r\n\r\n\r\ntype State = 'input' | 'post'\r\n/**\r\n * @description 应用模式-输入、发布\r\n */\r\nconst state: Ref<State> = ref('input')\r\nconst onInputState = computed(() => state.value === 'input')\r\nconst onPostState = computed(() => state.value === 'post')\r\nfunction appToState(newState: State) {\r\n    state.value = newState\r\n}\r\n\r\n/**\r\n * @description 状态管理的before-next钩子\r\n */\r\nasync function handleExecute(currentStage: number, targetStage: number) {\r\n    console.log('try: stage change:',currentStage,'->',targetStage)\r\n    \r\n    //当从 'input' (0) 阶段点击 'Propose items' (即进入 'post' 阶段)\r\n    if(currentStage === 0){\r\n        //1. 获取输入数据\r\n        const inputData = inputTree.getValue();\r\n        console.log('待发送的输入数据:', inputData)\r\n\r\n        //2. 发送数据到后端\r\n        try{\r\n            const requestBody = {\r\n                generalInformation: inputData.generalInformation,\r\n                bankData: inputData.bankData,\r\n                openItemSelection: inputData.openItemSelection\r\n            };\r\n\r\n            const response = await fetch(`${API_BASE_URL}/api/finance/searchOpenItems`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(requestBody)\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`HTTP error! status: ${response.status}`);\r\n            }\r\n\r\n            const result = await response.json();\r\n            console.log('后端的查询结果:', result);\r\n\r\n            //3. 处理响应数据\r\n            if (result.success && result.data) {\r\n                // 更新 openItems ref，用于在 post 阶段渲染\r\n                openItems.value = result.data.openItems ? result.data.openItems.map((item: OpenItem) => ({\r\n                    ...item,\r\n                    selected: false // 默认为未勾选\r\n                })) : [];\r\n                // 更新 balance 和 balanceUnit\r\n                balance.value = typeof result.data.balance === 'number' ? result.data.balance : parseFloat(result.data.balance || '0');\r\n                balanceUnit.value = result.data.balanceUnit || 'EUR';\r\n                \r\n                // 如果成功获取数据，允许跳转到下一阶段\r\n                return true; \r\n            } else {\r\n                // 后端返回成功但数据不符合预期\r\n                console.error('后端返回数据格式不正确:', result);\r\n                alert('查询未清项失败：' + (result.message || '数据格式错误'));\r\n                openItems.value = []; // 清空之前的可能数据\r\n                balance.value = 0;\r\n                balanceUnit.value = 'EUR';\r\n                return false; // 阻止跳转\r\n            }\r\n        } catch (error){\r\n            console.error('发送请求或处理响应时发生错误:', error);\r\n            alert('查询未清项失败，请检查网络或联系管理员。');\r\n            openItems.value = []; // 清空之前的可能数据\r\n            balance.value = 0;\r\n            balanceUnit.value = 'EUR';\r\n            return false; // 阻止跳转\r\n        }\r\n    }\r\n\r\n    if(currentStage === 1) {\r\n        // 当从 'post' (1) 阶段点击 'Post'，即提交数据\r\n        // 获取所有待清除的未清项\r\n        const itemsToPost = itemsToBeCleared.value;\r\n        console.log('准备提交的未清项:', itemsToPost);\r\n\r\n        if(balance.value < 0) {\r\n            alert('客户少付款，无法提交未清项。');\r\n            return false;\r\n        } else if(balance.value > 0) {\r\n            alert('客户多付款，无法提交未清项。');\r\n            return false;\r\n        } else {\r\n            try {\r\n                const response = await fetch(`${API_BASE_URL}/api/finance/postOpenItems`, {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify(itemsToPost)\r\n                });\r\n                \r\n                const result = await response.json();\r\n\r\n                if (result.success) {\r\n                    postedJournalEntryNumber.value = result.data.mockJournalEntry.journalEntryId || 'N/A'; // 获取过账后的 Journal Entry Number\r\n                    showPostSuccessModal.value = true; // 显示过账成功的模态框\r\n                    appContentRef.value.footerMessage = ''; // 提供反馈\r\n                    console.log('过账成功:', result);\r\n                    return true;\r\n                } else {\r\n                    alert('过账失败：' + (result.message || '未知错误'));\r\n                    return false;\r\n                }   \r\n            } catch (error) {\r\n                console.error('过账时发生错误:', error);\r\n                alert('过账失败，请检查网络。');\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n/**\r\n * @description 状态管理的before-prev钩子\r\n */\r\nasync function handleCancel(currentStage: number, _targetStage: number) {\r\n    if (currentStage === 1) { \r\n        const confirmValue = confirm('Cancel?')\r\n        if(confirmValue) {    \r\n            appContentRef.value.footerMessage = '';\r\n            openItems.value = [];\r\n            balance.value = 0;\r\n            balanceUnit.value = 'EUR';\r\n        }\r\n        console.log('取消操作，返回到输入阶段');\r\n        console.log('当前阶段:', currentStage, '目标阶段:', _targetStage);\r\n        console.log('确认值:', confirmValue);\r\n\r\n        appToState('input'); // 切换内部状态，控制 template 渲染\r\n\r\n        return confirmValue \r\n    }\r\n    return true \r\n}\r\n\r\n/**\r\n * @description 状态管理的after-next钩子\r\n */\r\nasync function handleAfterNext(_currentStage: number, _targetStage: number) {\r\n    // 导航到下一阶段后执行\r\n    if (_currentStage === 0) { // 如果导航到了 'post' 阶段\r\n        appToState('post'); // 切换内部状态，控制 template 渲染\r\n        appContentRef.value.footerMessage = 'Open items have been loaded'; // 可以在这里提供反馈\r\n    }\r\n}\r\n\r\n/**\r\n * @description 状态管理的after-prev钩子\r\n */\r\nasync function handleAfterPrev(_currentStage: number, _targetStage: number) {\r\n    // console.log('try: after-prev钩子被触发:', _currentStage, '->', _targetStage);\r\n    // // 导航到上一阶段后执行\r\n    // if (_targetStage === 0) { // 如果导航回到了 'input' 阶段\r\n    //     console.log('返回到输入阶段, handleAfterPrev钩子被触发');\r\n    //     appToState('input'); // 切换内部状态，控制 template 渲染\r\n    //     appContentRef.value.footerMessage = '输入信息！'; // 清空消息\r\n    // }\r\n}\r\n\r\n\r\n/**\r\n * @description 切换当前行的选中状态\r\n * @param item 当前行数据\r\n */\r\nfunction toggleRowSelection(item: OpenItem) {\r\n    // 切换当前行的 selected 状态\r\n    item.selected = !item.selected;\r\n}\r\n\r\n\r\n/**\r\n * @description 清账选中的未清项\r\n */\r\nfunction clearSelectedItems() {\r\n    const selectedItems = openItems.value.filter(item => item.selected);\r\n\r\n    if (selectedItems.length === 0) {\r\n        alert('请先选择要清除的未清项！');\r\n        return;\r\n    }\r\n\r\n    // 计算被清除项的总金额\r\n    let clearedAmount = 0;\r\n    selectedItems.forEach(item => {\r\n        clearedAmount += item.amount;\r\n    });\r\n\r\n    // 将选中的项添加到 itemsToBeCleared\r\n    itemsToBeCleared.value.push(...selectedItems);\r\n\r\n    // 从 openItems 中移除这些项\r\n    openItems.value = openItems.value.filter(item => !item.selected);\r\n\r\n    // 更新 balance：从当前余额中减去被清除项的总金额\r\n    balance.value -= clearedAmount;\r\n\r\n    // 重置 itemsToBeCleared 中项的 selected 状态\r\n    itemsToBeCleared.value.forEach(item => {\r\n        item.selected = false;\r\n    });\r\n\r\n    console.log(`成功清除 ${selectedItems.length} 项未清项。`);\r\n}\r\n\r\n/**\r\n * @description 移除 itemsToBeCleared 中的选中项\r\n */\r\nfunction removeItemsToBeCleared() {\r\n    const selectedItems = itemsToBeCleared.value.filter(item => item.selected);\r\n\r\n    if (selectedItems.length === 0) {\r\n        alert('请先选择要移除的项！');\r\n        return;\r\n    }\r\n\r\n    openItems.value.push(...selectedItems); // 将选中的项重新添加到 openItems\r\n\r\n    // 从 itemsToBeCleared 中移除选中的项\r\n    itemsToBeCleared.value = itemsToBeCleared.value.filter(item => !item.selected);\r\n\r\n    // 更新 balance：将被移除项的金额加回到余额中\r\n    let removedAmount = 0;\r\n    selectedItems.forEach(item => {\r\n        removedAmount += item.amount;\r\n    });\r\n    balance.value += removedAmount;\r\n\r\n    // 重置 itemsToBeCleared 中项的 selected 状态\r\n    itemsToBeCleared.value.forEach(item => {\r\n        item.selected = false;\r\n    });\r\n\r\n    console.log(`成功移除 ${selectedItems.length} 项已清除项。`);\r\n}\r\n\r\n/**\r\n * @description 关闭过账成功模态框\r\n */\r\nfunction closePostSuccessModal() {\r\n    showPostSuccessModal.value = false;\r\n\r\n    console.log('关闭过账成功模态框');\r\n    openItems.value = [];\r\n    itemsToBeCleared.value = [];\r\n    balance.value = 0;\r\n    balanceUnit.value = 'EUR';\r\n    appContentRef.value.goToStage(0); // 返回到输入阶段\r\n    appToState('input'); // 切换内部状态，控制 template 渲染\r\n}\r\n\r\n\r\n/**\r\n * @description 查看过账成功的 Journal Entry 详情\r\n */\r\nfunction viewJournalEntryDetails() {\r\n    // 隐藏成功提示模态框\r\n    showPostSuccessModal.value = false;\r\n\r\n    if (postedJournalEntryNumber.value) {\r\n        // 跳转到新的详情路由，并传递凭证编号作为参数\r\n        router.push({\r\n            name: 'DisplayJournalEntry', // 路由名称\r\n            params: { id: postedJournalEntryNumber.value } // 传递参数\r\n        });\r\n    } else {\r\n        alert('无法获取凭证编号进行查看。');\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.total {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr;\r\n    gap: 20px;\r\n}\r\n\r\n#generalInfo {\r\n    grid-column: 1;\r\n    grid-row: 1 / 3; \r\n}\r\n\r\n#bankData {\r\n    grid-column: 2;\r\n    grid-row: 1;\r\n}\r\n\r\n#openItemSelection {\r\n    grid-column: 2;\r\n    grid-row: 2; \r\n}\r\n\r\n:deep(.generalInformation--dict-leaf-section) {\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 10px;\r\n}\r\n\r\n:deep(.openItemSelection--dict-leaf-section) {\r\n    grid-template-columns: 50% 50%;;\r\n}\r\n\r\n:deep(.openItemSelection-accountType--wrapper) {\r\n    grid-column: 1;\r\n}\r\n\r\n:deep(.openItemSelection-accountId--wrapper) {\r\n    margin-left: auto;\r\n    grid-column: 2;\r\n}\r\n\r\n:deep(.bankData-amount--dict-leaf-section) {\r\n    display: grid;\r\n    grid-template-columns: 50% 50%;\r\n}\r\n\r\n:deep(.bankData-amount-amount--wrapper) {\r\n    grid-column: 1;\r\n}\r\n\r\n:deep(.bankData-amount-unit--wrapper) {\r\n    grid-column: 2;\r\n}\r\n\r\n.query-results-list {\r\n    width: 100%;\r\n    font-size: 1em;\r\n    color: var(--color-text-primary);\r\n}\r\n\r\n.material-document-rows-container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    overflow: hidden;\r\n}\r\n\r\n.header-item, .row-item {\r\n    align-self: center;\r\n    padding: 0 10px; /* Add horizontal padding for text */\r\n    box-sizing: border-box; /* Include padding in width calculation */\r\n}\r\n\r\n/* 调整列宽比例以适应新增的勾选框列 */\r\n.checkbox-header, .checkbox-cell {\r\n    flex-basis: 3%;\r\n    text-align: center;\r\n}\r\n.company-code { flex-basis: 10%; text-align: center;}\r\n.account { flex-basis: 12%; text-align: center;}\r\n.journal-entry { flex-basis: 12%; text-align: center;}\r\n.journal-entry-type { flex-basis: 16%; text-align: center;} /* 调整 */\r\n.journal-entry-date { flex-basis: 10%; text-align: center;}\r\n.net-due-date { flex-basis: 10%; text-align: center;}\r\n.amount { flex-basis: 8%; text-align: right; padding-right: 10px;}\r\n.assignment { flex-basis: 12%; text-align: center;}\r\n.arrow-icon { flex: 0 0 2%; text-align: right; padding-right: 20px;} /* 调整 */\r\n\r\n.material-document-row-header,\r\n.material-document-row {\r\n    width: 100%;\r\n    display: flex;\r\n    align-items: center;\r\n    /* border-bottom: 1px solid var(--theme-color-lighter); */\r\n    padding: 8px 0; /* Add padding for better spacing */\r\n    transition: all 0.3s ease; /* 添加过渡效果 */\r\n}\r\n\r\n.material-document-row {\r\n    cursor: pointer; /* 将光标设置为指针，表示可点击 */\r\n    position: relative; /* 确保 box-shadow 在堆叠上下文中正确显示 */\r\n    transition: background-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;\r\n}\r\n\r\n.material-document-row:hover {\r\n    background-color: var(--theme-color-lighter);\r\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); /* 悬停时阴影更明显，模拟“浮起” */\r\n    transform: translateY(-2px); /* 悬停时轻微上移，增加层次感 */\r\n}\r\n\r\n.material-document-row:active {\r\n    /* 点击时下沉效果 */\r\n    background-color: var(--theme-color-table-header-bg); /* 可以选择更深一点的颜色 */\r\n    transform: translateY(1px); /* 向下移动1px，模拟“下沉” */\r\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05); /* 阴影变小或移除，模拟“压平” */\r\n}\r\n.material-document-row:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.material-document-row-header {\r\n    background-color: var(--theme-color-table-header-bg);\r\n    font-weight: bold;\r\n    color: var(--theme-color-table-header-text);\r\n}\r\n\r\n.checkbox-cell {\r\n    display: flex; /* 让勾选框居中 */\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.checkbox-cell input[type=\"checkbox\"] {\r\n    appearance: none;\r\n    -webkit-appearance: none; /* 兼容性前缀 */\r\n    -moz-appearance: none; /* 兼容性前缀 */\r\n\r\n    /* 1. 设置勾选框的基础尺寸和边框 */\r\n    width: 18px; /* 自定义宽度 */\r\n    height: 18px; /* 自定义高度 */\r\n    background-color: white;\r\n    border: 1px solid var(--theme-color-dark); /* 边框颜色 */\r\n    border-radius: 5px; /* 轻微圆角 */\r\n    cursor: pointer; /* 显示手型光标 */\r\n    position: relative; /* 为伪元素定位 */\r\n    outline: none; /* 移除点击时的外边框 */\r\n    transition: background-color 0.5s, border-color 0.5s; /* 添加过渡效果 */\r\n}\r\n\r\n/* 2. 勾选框被选中时的样式 */\r\n.checkbox-cell input[type=\"checkbox\"]:checked {\r\n    background-color: var(--theme-color-dark); /* 勾选时的背景色 */\r\n    border-color: var(--theme-color-dark); /* 勾选时的边框色 */\r\n}\r\n\r\n/* 3. 使用伪元素创建勾选标记 */\r\n.checkbox-cell input[type=\"checkbox\"]::before {\r\n    content: '';\r\n    display: block;\r\n    width: 10px; /* 勾选标记宽度 */\r\n    height: 5px; /* 勾选标记高度 */\r\n    border-left: 2px solid white; /* 勾选标记左边 */\r\n    border-bottom: 2px solid white; /* 勾选标记下边 */\r\n    transform: rotate(-45deg); /* 旋转形成勾的形状 */\r\n    position: absolute;\r\n    top: 4px; /* 微调位置 */\r\n    left: 3px; /* 微调位置 */\r\n    opacity: 0; /* 默认隐藏 */\r\n    transition: opacity 0.5s; /* 添加过渡效果 */\r\n}\r\n\r\n/* 4. 勾选框被选中时显示勾选标记 */\r\n.checkbox-cell input[type=\"checkbox\"]:checked::before {\r\n    opacity: 1; /* 勾选时显示 */\r\n}\r\n\r\n.table-footer-bar {\r\n    display: flex;\r\n    justify-content: space-between; /* 使两边的内容分散对齐 */\r\n    align-items: center;\r\n    padding: 10px 15px; /* 内边距 */\r\n    background-color: var(--theme-color-table-header-bg); /* 与表头背景色一致 */\r\n    margin-top: 10px; /* 与表格顶部留些距离 */\r\n    color: var(--theme-color-table-header-text); /* 文字颜色 */\r\n    font-size: 0.9em;\r\n}\r\n\r\n.select-all-checkbox {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px; /* 勾选框和文字之间的间距 */\r\n}\r\n\r\n.select-all-checkbox input[type=\"checkbox\"] {\r\n    background-color: white;\r\n    appearance: none;\r\n    -webkit-appearance: none;\r\n    -moz-appearance: none;\r\n    width: 18px;\r\n    height: 18px;\r\n    border: 1px solid var(--theme-color-table-header-text);\r\n    border-radius: 5px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    outline: none;\r\n    transition: background-color 0.5s, border-color 0.5s;\r\n    flex-shrink: 0; /* 防止勾选框被压缩 */\r\n}\r\n\r\n.select-all-checkbox input[type=\"checkbox\"]:checked {\r\n    background-color: var(--theme-color-table-header-text);\r\n    border-color: var(--theme-color-table-header-text);\r\n}\r\n\r\n.select-all-checkbox input[type=\"checkbox\"]::before {\r\n    content: '';\r\n    display: block;\r\n    width: 10px;\r\n    height: 5px;\r\n    border-left: 2px solid var(--theme-color-dark);\r\n    border-bottom: 2px solid var(--theme-color-dark);\r\n    transform: rotate(-45deg);\r\n    position: absolute;\r\n    top: 4px;\r\n    left: 3px;\r\n    opacity: 0;\r\n    transition: opacity 0.2s;\r\n}\r\n\r\n.select-all-checkbox input[type=\"checkbox\"]:checked::before {\r\n    opacity: 1;\r\n}\r\n\r\n/* 禁用状态下的全选勾选框样式 */\r\n.select-all-checkbox input[type=\"checkbox\"]:disabled {\r\n    cursor: not-allowed;\r\n    background-color: var(--theme-color-disabled-bg, #f0f0f0); /* 禁用时的背景色 */\r\n    border-color: var(--theme-color-disabled-border, #ccc); /* 禁用时的边框色 */\r\n    opacity: 0.6; /* 降低透明度表示禁用 */\r\n}\r\n\r\n.select-all-checkbox input[type=\"checkbox\"]:disabled::before {\r\n    border-left-color: var(--theme-color-disabled-text, #aaa);\r\n    border-bottom-color: var(--theme-color-disabled-text, #aaa);\r\n}\r\n\r\n.selected-items-count {\r\n    font-weight: bold;\r\n}\r\n\r\n.btn-container {\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    gap:10px;\r\n    margin-top: 20px; /* 与表格底部留些距离 */\r\n}\r\n\r\n.btn {\r\n    min-width: 120px;\r\n    display: inline-flex; /* 使内容居中更方便 */\r\n    align-items: center; /* 垂直居中 */\r\n    justify-content: center; /* 水平居中 */\r\n    padding: 8px 25px;\r\n    border: 2px solid transparent; /* 初始透明边框 */\r\n    border-radius: 5px;\r\n    background-color: var(--btn-default-bg); \r\n    color:var(--btn-default-text);\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n    text-align: center;\r\n    text-decoration: none; /* 移除可能的下划线（如果是a标签）*/\r\n    cursor:default;\r\n    outline: none; /* 移除默认焦点轮廓 */\r\n    transition: all 0.3s ease; /* 平滑过渡所有属性 */\r\n}\r\n\r\n.btn:hover {\r\n    background-color: var(--btn-hover-bg); /* 悬停时改变背景色 */\r\n    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15); /* 悬停时加深阴影 */\r\n    transform: translateY(-2px); /* 悬停时轻微上浮 */\r\n    color: var(--btn-hover-text); /* 悬停时改变文字颜色 */\r\n}\r\n\r\n.btn:active {\r\n    background-color: var(--btn-active-bg); /* 点击时改变背景色 */\r\n    box-shadow: 0 2px 4px var(--btn-active-shadow);\r\n    transform: translateY(0); /* 点击时恢复位置 */\r\n}\r\n\r\n.btn:focus {\r\n    border-color: var(--btn-focus-border); /* 获得焦点时显示蓝色边框 */\r\n    box-shadow: 0 0 0 0.2rem var(--btn-focus-shadow); /* 焦点光晕 */\r\n}\r\n\r\n.modal-overlay {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: rgba(0, 0, 0, 0.5); /* 半透明黑色背景 */\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    z-index: 1000; /* 确保模态窗口在最上层 */\r\n}\r\n\r\n.modal-content {\r\n    background-color: white;\r\n    padding: 30px;\r\n    border-radius: 8px;\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);\r\n    text-align: center;\r\n    max-width: 400px;\r\n    width: 90%;\r\n    animation: fadeIn 0.3s ease-out; /* 添加出现动画 */\r\n}\r\n\r\n.modal-content h2 {\r\n    color: var(--theme-color-dark); /* 使用你的主题颜色 */\r\n    margin-top: 0;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.modal-content p {\r\n    font-size: 1.1em;\r\n    color: var(--color-text-primary);\r\n    margin-bottom: 25px;\r\n}\r\n\r\n.modal-actions {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: center;\r\n    gap: 15px; /* 按钮之间的间距 */\r\n}\r\n\r\n/* 模态框出现动画 */\r\n@keyframes fadeIn {\r\n    from {\r\n        opacity: 0;\r\n        transform: scale(0.9);\r\n    }\r\n    to {\r\n        opacity: 1;\r\n        transform: scale(1);\r\n    }\r\n}\r\n</style>","import script from \"./postingIncomingPayments.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./postingIncomingPayments.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./postingIncomingPayments.vue?vue&type=style&index=0&id=fa345ee2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fa345ee2\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","id","_hoisted_3","_hoisted_4","_hoisted_5","style","_hoisted_6","_hoisted_7","_hoisted_8","key","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_defineComponent","__name","setup","__props","journalEntryTypeOptions","balance","ref","balanceUnit","API_BASE_URL","window","appContentRef","openItems","itemsToBeCleared","selectedOpenItems","computed","value","filter","item","selected","selectedItemsToBeCleared","allSelected_openItems","get","length","set","forEach","allSelected_itemsToBeCleared","showPostSuccessModal","postedJournalEntryNumber","inputTree","createTreeFromConfig","cns","searchMethods","bpSearch","options","GLAccountSearch","hideLabel","CurrencyUnitSearch","generalInfoTree","bankDataTree","openItemSelectionTree","onMounted","generalInformationNode","findNodeByPath","VarTree","console","error","bankDataNode","openItemSelectionNode","state","onInputState","appToState","newState","async","handleExecute","currentStage","targetStage","log","inputData","getValue","requestBody","generalInformation","bankData","openItemSelection","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","result","json","success","data","map","parseFloat","alert","message","itemsToPost","mockJournalEntry","journalEntryId","footerMessage","handleCancel","_targetStage","confirmValue","confirm","handleAfterNext","_currentStage","handleAfterPrev","toggleRowSelection","clearSelectedItems","selectedItems","clearedAmount","amount","push","removeItemsToBeCleared","removedAmount","closePostSuccessModal","goToStage","viewJournalEntryDetails","router","name","params","_ctx","_cache","_openBlock","_createBlock","AppContent","stages","nextText","prevText","ref_key","_withCtx","_createElementVNode","_withDirectives","_createVNode","VarBox","tree","_vShow","_toDisplayString","_createElementBlock","_Fragment","_renderList","index","onClick","$event","type","_withModifiers","_vModelCheckbox","companyCode","account","journalEntry","journalEntryType","journalEntryDate","netDueDate","assignment","disabled","_createTextVNode","_createCommentVNode","getCurrentStageName","_","__exports__"],"sourceRoot":""}